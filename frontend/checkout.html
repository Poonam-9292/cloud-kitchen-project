<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout & Payment</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      animation: gradientBG 10s ease infinite;
      background: linear-gradient(-45deg, #FF9A3C, #FF6B6B, #FFD166, #FF8C42);
      background-size: 400% 400%;
      font-family: 'Poppins', sans-serif;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .checkout-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(5px);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .cart-item {
      transition: all 0.3s ease;
      border-bottom: 1px dashed rgba(0,0,0,0.1);
    }

    .cart-item:hover {
      transform: translateY(-3px);
    }

    .food-thumbnail {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 12px;
      border: 2px solid white;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .pay-btn {
      background: linear-gradient(135deg, #FF5722, #FF9800);
      transition: all 0.3s;
      letter-spacing: 0.5px;
      font-weight: 700;
      text-transform: uppercase;
    }

    .pay-btn:hover {
      background: linear-gradient(135deg, #E64A19, #F57C00);
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(255, 87, 34, 0.3);
    }

    .input-field {
      transition: all 0.3s;
      border: 1px solid #e2e8f0;
    }

    .input-field:focus {
      border-color: #FF5722;
      box-shadow: 0 0 0 2px rgba(255, 87, 34, 0.2);
    }

    .payment-method {
      transition: all 0.3s;
    }

    .payment-method:hover {
      transform: translateY(-2px);
    }
  </style>
</head>

<body class="min-h-screen font-poppins">
  <div class="p-6 max-w-4xl mx-auto">
    <div class="flex justify-between items-center mb-8">
      <a href="cart.html" class="bg-white text-orange-500 p-3 rounded-full shadow-lg hover:bg-orange-100 transition-all">
        <span class="text-2xl">←</span>
      </a>
      <h1 class="text-4xl font-playfair font-bold text-white text-center drop-shadow-md">Checkout</h1>
      <div class="w-10"></div>
    </div>

    <div class="checkout-card p-8 mb-8">
      <h2 class="text-2xl font-playfair font-bold text-orange-500 mb-6">Your Order</h2>
      <div id="cart-items-container" class="space-y-4 mb-6"></div>
      <div class="space-y-3 mt-6">
        <div class="flex justify-between">
          <span class="text-gray-700">Subtotal:</span>
          <span class="font-semibold" id="subtotal">₹0.00</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-700">Tax (5%):</span>
          <span class="font-semibold" id="tax">₹0.00</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-700">Delivery Fee:</span>
          <span class="font-semibold" id="delivery-fee">₹40.00</span>
        </div>
        <div class="border-t border-gray-300 pt-3 flex justify-between">
          <span class="text-xl font-bold text-orange-500">Total:</span>
          <span class="text-xl font-bold" id="total">₹0.00</span>
        </div>
      </div>
    </div>

    <div class="checkout-card p-8 mb-8">
      <h2 class="text-2xl font-playfair font-bold text-orange-500 mb-6">Delivery Details</h2>
      <form id="payment-form" class="space-y-4">
        <div>
          <label class="block text-gray-700 mb-2">Full Name</label>
          <input type="text" placeholder="Enter your name" class="input-field w-full p-3 rounded-lg" required>
        </div>
        <div>
          <label class="block text-gray-700 mb-2">Mobile Number</label>
          <input type="tel" placeholder="Enter mobile number" class="input-field w-full p-3 rounded-lg" required>
        </div>
        <div>
          <label class="block text-gray-700 mb-2">Address</label>
          <input type="text" placeholder="Street address with landmarks" class="input-field w-full p-3 rounded-lg" required>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-gray-700 mb-2">City</label>
            <input type="text" id="city" placeholder="Your city" class="input-field w-full p-3 rounded-lg" required>
          </div>
          <div>
            <label class="block text-gray-700 mb-2">Pincode</label>
            <input type="text" id="pincode" placeholder="Postal code" class="input-field w-full p-3 rounded-lg" required>
          </div>
        </div>

        <div class="mt-6">
          <h3 class="text-xl font-semibold text-gray-800 mb-4">Payment Method</h3>
          <div class="space-y-3">
            <label class="payment-method flex items-center p-4 border rounded-lg cursor-pointer hover:border-orange-400">
              <input type="radio" name="payment" value="cod" class="mr-3" checked>
              <div>
                <h4 class="font-medium">Cash on Delivery</h4>
                <p class="text-sm text-gray-500">Pay when you receive your order</p>
              </div>
            </label>
            <label class="payment-method flex items-center p-4 border rounded-lg cursor-pointer hover:border-orange-400">
              <input type="radio" name="payment" value="upi" class="mr-3">
              <div>
                <h4 class="font-medium">UPI Payment</h4>
                <p class="text-sm text-gray-500">Pay using UPI apps</p>
              </div>
            </label>
            <label class="payment-method flex items-center p-4 border rounded-lg cursor-pointer hover:border-orange-400">
              <input type="radio" name="payment" value="card" class="mr-3">
              <div>
                <h4 class="font-medium">Credit/Debit Card</h4>
                <p class="text-sm text-gray-500">Pay with your card</p>
              </div>
            </label>
          </div>
        </div>

        <div id="additional-payment-fields" class="space-y-4 mt-4 hidden">
          <div id="upi-fields" class="hidden">
            <label class="block text-gray-700 mb-2">UPI ID</label>
            <input type="text" id="upi-id" placeholder="yourname@upi" class="input-field w-full p-3 rounded-lg">
          </div>
          <div id="card-fields" class="hidden space-y-4">
            <div>
              <label class="block text-gray-700 mb-2">Card Number</label>
              <input type="text" id="card-number" placeholder="1234 5678 9012 3456" class="input-field w-full p-3 rounded-lg">
            </div>
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-gray-700 mb-2">Expiry Date</label>
                <input type="text" id="card-expiry" placeholder="MM/YY" class="input-field w-full p-3 rounded-lg">
              </div>
              <div>
                <label class="block text-gray-700 mb-2">CVV</label>
                <input type="text" id="card-cvv" placeholder="123" class="input-field w-full p-3 rounded-lg">
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>

    <div class="text-center">
      <button type="submit" form="payment-form" class="pay-btn text-white px-8 py-4 rounded-xl text-lg font-semibold w-full max-w-md mx-auto">
        CONFIRM ORDER & PAY
      </button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      const cartContainer = document.getElementById('cart-items-container');
      const subtotalEl = document.getElementById('subtotal');
      const taxEl = document.getElementById('tax');
      const deliveryFeeEl = document.getElementById('delivery-fee');
      const totalEl = document.getElementById('total');
      const paymentForm = document.getElementById('payment-form');
      const additionalFields = document.getElementById('additional-payment-fields');
      const upiFields = document.getElementById('upi-fields');
      const cardFields = document.getElementById('card-fields');
      const pincodeInput = document.getElementById('pincode');
      const cityInput = document.getElementById('city');

      const renderCartItems = () => {
        cartContainer.innerHTML = '';
        let subtotal = 0;

        if (cart.length === 0) {
          cartContainer.innerHTML = '<p class="text-center text-gray-500 py-4">No items in cart</p>';
          subtotalEl.textContent = '₹0.00';
          taxEl.textContent = '₹0.00';
          deliveryFeeEl.textContent = '₹40.00';
          totalEl.textContent = '₹40.00';
          return;
        }

        cart.forEach(item => {
          const itemTotal = item.price * item.quantity;
          subtotal += itemTotal;

          const cartItem = document.createElement('div');
          cartItem.classList.add('cart-item', 'flex', 'justify-between', 'items-center', 'pb-4');

          cartItem.innerHTML = `
            <div class="flex items-center space-x-4">
              <img src="${item.image || 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?q=80&w=2080&auto=format&fit=crop'}" alt="${item.name}" class="food-thumbnail">
              <div>
                <h3 class="font-semibold text-gray-800">${item.name}</h3>
                <p class="text-gray-500 text-sm">${item.quantity} × ₹${item.price}</p>
              </div>
            </div>
            <span class="font-semibold">₹${itemTotal.toFixed(2)}</span>
          `;

          cartContainer.appendChild(cartItem);
        });

        const tax = subtotal * 0.05;
        const deliveryFee = 40;
        const total = subtotal + tax + deliveryFee;

        subtotalEl.textContent = `₹${subtotal.toFixed(2)}`;
        taxEl.textContent = `₹${tax.toFixed(2)}`;
        deliveryFeeEl.textContent = `₹${deliveryFee.toFixed(2)}`;
        totalEl.textContent = `₹${total.toFixed(2)}`;
      };

      document.querySelectorAll('input[name="payment"]').forEach(radio => {
        radio.addEventListener('change', (e) => {
          additionalFields.classList.remove('hidden');
          upiFields.classList.add('hidden');
          cardFields.classList.add('hidden');

          if (e.target.value === 'upi') {
            upiFields.classList.remove('hidden');
          } else if (e.target.value === 'card') {
            cardFields.classList.remove('hidden');
          } else {
            additionalFields.classList.add('hidden');
          }
        });
      });

      pincodeInput.addEventListener('blur', () => {
        const pincode = pincodeInput.value.trim();
        if (pincode.length === 6 && /^[1-9][0-9]{5}$/.test(pincode)) {
          fetch(`https://api.postalpincode.in/pincode/${pincode}`)
            .then(res => res.json())
            .then(data => {
              if (data[0].Status === "Success" && data[0].PostOffice && data[0].PostOffice.length > 0) {
                cityInput.value = data[0].PostOffice[0].District || '';
              } else {
                alert("Invalid Pincode or no data found.");
                cityInput.value = '';
              }
            })
            .catch(() => {
              alert("Failed to fetch location data. Try again later.");
            });
        } else {
          alert("Enter a valid 6-digit pincode.");
          cityInput.value = '';
        }
      });

      paymentForm.addEventListener('submit', (e) => {
        e.preventDefault();
        if (cart.length === 0) {
          alert('Your cart is empty!');
          return;
        }
        localStorage.removeItem('cart');
        window.location.href = 'order-status.html';
      });

      renderCartItems();
    });
  </script>
</body>

</html>
